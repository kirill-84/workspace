<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Поиск по многоуровнему списку</title>
</head>
<body>
<input type="text" id="searchInput" placeholder="Поиск...">
<ul id="originalList">
   <li>001
     <ul style="display: none">
       <li>sub directory
         <ul style="display: none">
           <li>last category
             <ul style="display: none">
               <li>Егор</li>
               <li>Пётр</li>
               <li>Алексей</li>
             </ul>
           </li>
         </ul>
       </li>
     </ul>
   </li>
   <li>002
     <ul style="display: none">
       <li>Андрей</li>
       <li>Егор</li>
       <li>Владимир</li>
     </ul>
   </li>
</ul>
<div id="searchResult" style="display: none;">Результатов нет.</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
  // Save the original list
  var originalList = $("#originalList").html();

  // Event listener for search input
  $("#searchInput").on("input", function() {
    var searchText = $(this).val().toLowerCase();

    // Clear previous search results
    $("#originalList").html(originalList);

    // Perform search after 3 letters
    if (searchText.length >= 3) {
      searchAndDisplayResults(searchText);
    } else {
      // Hide all child ul elements
      $("#originalList ul").hide();
    }
  });

  // Function to search and display results
  function searchAndDisplayResults(searchText) {
    var $listItems = $("#originalList li");

    $listItems.each(function() {
      var $currentItem = $(this);
      var $childUl = $currentItem.find("ul");

      // Check if the current item contains the search text
      if ($currentItem.text().toLowerCase().includes(searchText)) {
        // Show the current item
        $currentItem.show();
        $currentItem.parents("li").show();

        // Show all parent ul elements
        $currentItem.parents("ul").show();

        // Show all child ul elements
        $childUl.show();
      } else {
        // Hide the current item and its children
        $currentItem.hide();
        $childUl.hide();
      }
    });

    // Check if no results were found
    if ($("#originalList li:visible").length === 0) {
      $("#originalList").html("<li>No results found.</li>");
    }
  }
});
</script>

</body>
</html>
